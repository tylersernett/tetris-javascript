/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={32:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.horizontalCollision=t.verticalCollision=t.rotationCollision=t.pieceCollision=void 0;const o=r(407);function n(e){return e>=o.gBArrayHeight}function a(e){return e>o.gBArrayWidth-1||e<0}function i(e,t){return 0!==o.stoppedShapeArray[t][e]}t.pieceCollision=i,t.rotationCollision=function(e){let t=o.rotationIndex+e,r=o.curTetromino.rotations[(0,o.mod)(t,o.curTetromino.length)],l=!1;for(let e=0;e<r.length;e++){let t=r[e],s=t[0]+o.startX,c=t[1]+o.startY;if(a(s)){l=!0;break}if(n(c)){l=!0;break}if(i(s,c)){l=!0;break}}return l},t.verticalCollision=function(e){let t=o.curTetromino.rotations[o.rotationIndex],r=!1;for(let a=0;a<t.length;a++){let l=t[a],s=l[0]+o.startX,c=l[1]+o.startY;if(c+=e,n(c)||i(s,c)){r=!0;break}}if(r){for(let e=0;e<t.length;e++){let r=t[e],n=r[0]+o.startX,a=r[1]+o.startY;o.stoppedShapeArray[a][n]=o.curTetrominoImage}return(0,o.checkForCompletedRows)(),(0,o.createTetrominoFromNext)(),(0,o.drawCurTetrominoAndCheckGameOver)(),!0}return!1},t.horizontalCollision=function(e){if(0===e)return!1;let t=o.curTetromino.rotations[o.rotationIndex],r=!1;for(let n=0;n<t.length;n++){let l=t[n],s=l[0]+o.startX,c=l[1]+o.startY;if(s+=e,a(s)){r=!0;break}if(i(s,c)){r=!0;break}}return r}},407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkForCompletedRows=t.createTetrominoFromNext=t.curTetrominoImage=t.curTetromino=t.drawCurTetrominoAndCheckGameOver=t.mod=t.rotationIndex=t.startY=t.startYDefault=t.startX=t.startXDefault=t.stoppedShapeArray=t.gBArrayWidth=t.gBArrayHeight=void 0;const o=r(32);let n,a,i,l,s,c,u,d,h,y,f,m,g,p,k,b,A,v,I,C;document.addEventListener("DOMContentLoaded",(()=>{!function(){n=document.querySelector("#my-canvas"),c=document.getElementById("game-over"),a=document.getElementById("highscore-outer"),i=document.getElementById("highscore-display"),l=document.getElementById("highscore-prompt"),s=document.querySelector("#score-form-submit"),y=document.querySelector("#name-submit"),u=document.getElementById("score"),d=document.getElementById("lines"),h=document.getElementById("level"),f=document.querySelector("#block-t"),m=document.querySelector("#block-i"),g=document.querySelector("#block-j"),p=document.querySelector("#block-sq"),k=document.querySelector("#block-l"),b=document.querySelector("#block-s"),A=document.querySelector("#block-z"),v=[f,m,g,p,k,b,A],T=n.getContext("2d"),B=4*H+t.gBArrayWidth*(Y+2*H),X=2*H+t.gBArrayHeight*(Y+2*H);n.width=1*(B+5*(Y+2*H)),n.height=1*(5+X),T.scale(1,1),function(){I=Array.from({length:t.gBArrayHeight},(()=>Array.from({length:t.gBArrayWidth},(()=>new w(0,0)))));let e=1+Y+1;for(let r=0;r<t.gBArrayHeight;r++)for(let o=0;o<t.gBArrayWidth;o++)I[r][o]=new w(3+e*o,1+e*r);for(let t=0;t<3;t++)for(let r=0;r<4;r++)S[t][r]=new w(244+e*r,105+e*t)}(),D.push(new q([[[0,1],[1,1],[2,1],[1,2]],[[1,0],[0,1],[1,1],[1,2]],[[0,1],[1,1],[2,1],[1,0]],[[1,0],[2,1],[1,1],[1,2]]])),D.push(new q([[[0,2],[1,2],[2,2],[3,2]],[[2,0],[2,1],[2,2],[2,3]]])),D.push(new q([[[0,1],[1,1],[2,1],[2,2]],[[1,0],[0,2],[1,1],[1,2]],[[0,1],[1,1],[2,1],[0,0]],[[1,0],[2,0],[1,1],[1,2]]])),D.push(new q([[[1,1],[2,1],[1,2],[2,2]]])),D.push(new q([[[0,1],[1,1],[2,1],[0,2]],[[1,0],[0,0],[1,1],[1,2]],[[0,1],[1,1],[2,1],[2,0]],[[1,0],[2,2],[1,1],[1,2]]])),D.push(new q([[[1,1],[2,1],[0,2],[1,2]],[[1,1],[2,1],[1,0],[2,2]]])),D.push(new q([[[0,1],[1,1],[1,2],[2,2]],[[2,0],[1,1],[1,2],[2,1]]])),document.addEventListener("keydown",re),document.addEventListener("keyup",oe,!1)}(),z=!1,s.disabled=!1,W=0,j=1,F=0,O=!1,ye(),L=60,le(),t.startX=t.startXDefault,t.startY=t.startYDefault,c.style.visibility="hidden",a.style.visibility="hidden",l.style.visibility="hidden",C=x(),t.stoppedShapeArray=x(t.stoppedShapeArray),T.clearRect(0,0,n.width,n.height),he(),de(),R=!0,clearInterval(E),E=setInterval(te,1e3/L),me()}));class w{constructor(e,t){this.x=e,this.y=t}}function x(e){return new Array(t.gBArrayHeight).fill(0).map((()=>new Array(t.gBArrayWidth).fill(0)))}t.gBArrayHeight=20,t.gBArrayWidth=10;const S=Array.from({length:3},(()=>Array.from({length:4},(()=>new w(0,0)))));let T,B,X,Y=21,H=1;class q{constructor(e){this.rotations=e}get length(){return this.rotations?.length||0}getSecondArrayLength(){return this.rotations[0]?.length||0}}let D=[];t.startXDefault=4,t.startX=t.startXDefault,t.startYDefault=0,t.startY=t.startYDefault;let E,M,L,R,W=0,j=1,F=0,O=!1,z=!1,_="#f8f8f8",G="black";t.rotationIndex=0;let N,$,P=0,J=0,K=0,Q=0,U=6,V=2,Z=-U,ee=-V;function te(){var e;O||(T.clearRect(0,0,n.width,n.height),T.fillStyle=_,T.fillRect(0,0,B,X),T.strokeStyle=G,T.strokeRect(.5,.5,B-1,X-1),0!==P&&Q-Z>=U&&(e=P,(0,o.horizontalCollision)(e)||(ue(),t.startX+=e,se()),Z=Q),0!==J&&Q-ee>=V&&R&&(ie(),ee=Q),se(),fe(),ce(),Q++)}function re(e){O||(37===e.keyCode?P=-1:39===e.keyCode?P=1:40===e.keyCode?J=1:88===e.keyCode?(K=1,ae(1)):90===e.keyCode&&(K=-1,ae(-1)))}function oe(e){37===e.keyCode||39===e.keyCode?P=0:40===e.keyCode?(J=0,R=!0):88!==e.keyCode&&90!==e.keyCode||(K=0)}function ne(e,t){return(e%t+t)%t}function ae(e){O||(0,o.rotationCollision)(e)||(ue(),t.rotationIndex+=e,t.rotationIndex=ne(t.rotationIndex,t.curTetromino.length),se())}function ie(){O||(0,o.verticalCollision)(1)||(ue(),t.startY++,se())}function le(){let e;switch(j){case 1:e=48;break;case 2:e=43;break;case 3:e=38;break;case 4:e=33;break;case 5:e=28;break;case 6:e=23;break;case 7:e=18;break;case 8:e=13;break;case 9:e=8;break;case 10:e=6;break;case 11:case 12:case 13:e=5;break;case 14:case 15:case 16:e=4;break;case 17:case 18:case 19:e=3;break;case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:e=2;break;default:e=1}if(L!==e){L=e;let t=e/60*1e3;clearInterval(M),M=setInterval((()=>{O||ie()}),t)}}function se(){let e=!1;for(let r=0;r<t.curTetromino.rotations[t.rotationIndex].length;r++){let n=t.curTetromino.rotations[t.rotationIndex][r][0]+t.startX,a=t.curTetromino.rotations[t.rotationIndex][r][1]+t.startY;C[a][n]=1;let i=I[a][n].x,l=I[a][n].y;T.drawImage(t.curTetrominoImage,i,l),(0,o.pieceCollision)(n,a)&&(e=!0)}e&&(O=!0,c.style.visibility="visible",async function(e){z=!0;const t=await me(),r=t.map((e=>`<li>${e.name}: ${e.score}</li>`)).join("");i.innerHTML=`<ol>${r}</ol>`,a.style.visibility="visible",e&&(t.length<5||W>t[4]?.score)&&(l.style.visibility="visible")}(!0),clearInterval(E))}function ce(){let e=S[0][0].x,t=S[0][0].y;T.fillStyle="white",T.fillRect(e,t,4*(1+Y+1),3*(1+Y+1));for(let e=0;e<N.rotations[0].length;e++){let t=N.rotations[0][e][0],r=N.rotations[0][e][1],o=S[r][t].x,n=S[r][t].y;T.drawImage($,o,n)}}function ue(){let e=.5;for(let r=0;r<t.curTetromino.rotations[t.rotationIndex].length;r++){let o=t.curTetromino.rotations[t.rotationIndex][r][0]+t.startX,n=t.curTetromino.rotations[t.rotationIndex][r][1]+t.startY;C[n][o]=0;let a=I[n][o].x,i=I[n][o].y;T.fillStyle=_,T.fillRect(a-e,i-e,Y+e+2,Y+e+2)}}function de(){R=!1,t.startX=t.startXDefault,t.startY=t.startYDefault,t.rotationIndex=0,t.curTetromino=N,t.curTetrominoImage=$,he(),ce()}function he(){let e=Math.floor(Math.random()*D.length);N=D[e],console.log(N),$=v[e]}function ye(){u.innerHTML=W.toString(),d.innerHTML=F.toString(),h.innerHTML=j.toString()}function fe(){for(let e=0;e<t.gBArrayHeight;e++)for(let r=0;r<t.gBArrayWidth;r++){let o=I[e][r].x,n=I[e][r].y,a=0!==t.stoppedShapeArray[e][r]?t.stoppedShapeArray[e][r]:void 0;a&&T.drawImage(a,o,n)}}async function me(){try{const e=await fetch("https://tetris-javascript.onrender.com/highscores");return await e.json()}catch(e){return console.error("Error getting scores:",e),[]}}t.mod=ne,t.drawCurTetrominoAndCheckGameOver=se,t.createTetrominoFromNext=de,t.checkForCompletedRows=function(){let e=0;for(let r=0;r<t.gBArrayHeight;r++){let o=!1;if(t.stoppedShapeArray[r].every((e=>0!==e))&&(o=!0),o){e++;for(let e=0;e<t.gBArrayWidth;e++)t.stoppedShapeArray[r][e]=0,C[r][e]=0;let o=t.stoppedShapeArray.splice(r,1);t.stoppedShapeArray.unshift(...o);let n=C.splice(r,1);C.unshift(...n)}}e>0&&(W+=function(e){switch(e){case 1:return 40;case 2:return 100;case 3:return 300;case 4:return 1200;default:return 0}}(e)*j,F+=e,j=Math.floor(F/10)+1,le(),ye(),fe())}}},t={};!function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}(407)})();